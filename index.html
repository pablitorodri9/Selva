<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MisiÃ³n Selva: Â¡Exploradores en AcciÃ³n!</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600;700&display=swap" rel="stylesheet">
  
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/recharts@2.12.0/umd/Recharts.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    body {
      font-family: 'Fredoka', sans-serif;
      background-color: #FDFBF7;
      scroll-behavior: smooth;
    }
    /* Barra de desplazamiento personalizada */
    ::-webkit-scrollbar { width: 12px; }
    ::-webkit-scrollbar-track { background: #ECFDF5; }
    ::-webkit-scrollbar-thumb {
      background-color: #34D399;
      border-radius: 20px;
      border: 3px solid #ECFDF5;
    }
    .animate-float {
      animation: float 3s ease-in-out infinite;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    // 1. Extraemos las herramientas de React y Recharts para usarlas fÃ¡cilmente
    const { useState, useEffect, useMemo } = React;
    const { 
      BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, 
      PieChart, Pie, Cell, Legend 
    } = Recharts;

    // --- DATOS Y CONSTANTES ---
    const ANIMALS = [
      { id: 1, name: "LeÃ³n", icon: "ğŸ¦", type: "walk", diet: "meat", desc: "El Rey de la selva. Ruge muy fuerte." },
      { id: 2, name: "TucÃ¡n", icon: "ğŸ¦œ", type: "fly", diet: "fruit", desc: "Tiene un pico enorme de colores." },
      { id: 3, name: "Cocodrilo", icon: "ğŸŠ", type: "swim", diet: "meat", desc: "Vive en el rÃ­o y tiene dientes grandes." },
      { id: 4, name: "Elefante", icon: "ğŸ˜", type: "walk", diet: "plant", desc: "Es el animal mÃ¡s grande y pesado." },
      { id: 5, name: "Mono", icon: "ğŸ’", type: "walk", diet: "fruit", desc: "Le encanta saltar por los Ã¡rboles." },
      { id: 6, name: "Serpiente", icon: "ğŸ", type: "walk", diet: "meat", desc: "Se arrastra por el suelo sin patas." },
      { id: 7, name: "Ãguila", icon: "ğŸ¦…", type: "fly", diet: "meat", desc: "Vuela muy alto y ve muy bien." },
      { id: 8, name: "Rana", icon: "ğŸ¸", type: "swim", diet: "bug", desc: "Salta mucho y come moscas." }
    ];

    const LAYERS = {
      emergente: {
        title: "El Ãtico (Emergente)",
        desc: "Â¡AquÃ­ da mucho el sol! Es la parte mÃ¡s alta de los Ã¡rboles gigantes.",
        icon: "ğŸ¦…",
        color: "bg-blue-200"
      },
      dosel: {
        title: "El Techo (Dosel)",
        desc: "Es como el techo de la selva. AquÃ­ viven los monos y tucanes.",
        icon: "ğŸ’",
        color: "bg-green-400"
      },
      sotobosque: {
        title: "Piso Medio (Sotobosque)",
        desc: "AquÃ­ hay poca luz y muchas plantas grandes. Los jaguares se esconden aquÃ­.",
        icon: "ğŸ†",
        color: "bg-green-600"
      },
      suelo: {
        title: "El Suelo",
        desc: "EstÃ¡ oscuro y hÃºmedo. AquÃ­ viven los insectos y elefantes.",
        icon: "ğŸœ",
        color: "bg-yellow-800"
      }
    };

    const speedMap = { 'LeÃ³n': 80, 'TucÃ¡n': 40, 'Cocodrilo': 25, 'Elefante': 40, 'Mono': 35, 'Serpiente': 15, 'Ãguila': 120, 'Rana': 10 };

    // --- COMPONENTE DE GRÃFICOS ---
    const JungleCharts = () => {
      const dietData = [
        { name: 'Carne', value: 3, color: '#EF4444' },
        { name: 'Plantas', value: 2, color: '#10B981' },
        { name: 'Frutas', value: 2, color: '#F59E0B' },
        { name: 'Bichos', value: 1, color: '#6366F1' },
      ];

      return (
        <section id="fun" className="container mx-auto px-4 py-12">
          <div className="mb-12 text-center">
            <h2 className="text-3xl md:text-4xl font-bold text-green-700 mb-4">ğŸ“Š Datos Curiosos</h2>
          </div>
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto">
            <div className="bg-white rounded-3xl shadow-xl p-6 border-l-8 border-orange-400">
              <h3 className="text-xl font-bold text-orange-600 mb-6 text-center">ğŸ½ï¸ Â¿QuÃ© comen?</h3>
              <div className="h-[250px]">
                <ResponsiveContainer width="100%" height="100%">
                  <PieChart>
                    <Pie data={dietData} cx="50%" cy="50%" innerRadius={50} outerRadius={70} dataKey="value">
                      {dietData.map((entry, index) => <Cell key={`cell-${index}`} fill={entry.color} />)}
                    </Pie>
                    <Tooltip />
                    <Legend />
                  </PieChart>
                </ResponsiveContainer>
              </div>
            </div>
            <div className="bg-white rounded-3xl shadow-xl p-6 border-l-8 border-blue-400">
              <h3 className="text-xl font-bold text-blue-600 mb-6 text-center">âš¡ Velocidad (km/h)</h3>
              <div className="h-[250px]">
                <ResponsiveContainer width="100%" height="100%">
                  <BarChart data={[{name:'Jaguar', s:80}, {name:'NiÃ±o', s:20}, {name:'Perezoso', s:1}]} layout="vertical">
                    <XAxis type="number" hide />
                    <YAxis dataKey="name" type="category" width={80} tick={{fontSize: 12, fontWeight: 'bold'}} />
                    <Tooltip />
                    <Bar dataKey="s" fill="#3B82F6" radius={[0, 10, 10, 0]} />
                  </BarChart>
                </ResponsiveContainer>
              </div>
            </div>
          </div>
        </section>
      );
    };

    // --- COMPONENTE DE JUEGOS ---
    const JungleGames = () => {
      const [mode, setMode] = useState('menu');
      const [score, setScore] = useState(0);
      const [question, setQuestion] = useState(null);
      const [feedback, setFeedback] = useState(null);

      const generateQuestion = (currentMode) => {
        setFeedback(null);
        if (currentMode === 'layers') {
          const animal = ANIMALS[Math.floor(Math.random() * ANIMALS.length)];
          let correct = 'suelo';
          if (animal.type === 'fly') correct = 'emergente';
          else if (['Mono', 'TucÃ¡n'].includes(animal.name)) correct = 'dosel';
          else if (animal.name === 'Serpiente') correct = 'sotobosque';
          setQuestion({ animal, correct });
        } else if (currentMode === 'movement') {
          const animal = ANIMALS[Math.floor(Math.random() * ANIMALS.length)];
          setQuestion({ animal, correct: animal.type });
        } else if (currentMode === 'speed') {
          const shuffled = [...ANIMALS].sort(() => 0.5 - Math.random()).slice(0, 3);
          const fastest = [...shuffled].sort((a, b) => speedMap[b.name] - speedMap[a.name])[0];
          setQuestion({ options: shuffled, correct: fastest.id });
        }
      };

      const startMode = (m) => {
        setMode(m);
        generateQuestion(m);
      };

      const handleAnswer = (ans) => {
        if (ans === question.correct) {
          setScore(s => s + 10);
          setFeedback({ type: 'success', text: 'Â¡IncreÃ­ble! ğŸŒŸ' });
          setTimeout(() => generateQuestion(mode), 1200);
        } else {
          setFeedback({ type: 'error', text: 'Â¡Casi! Prueba de nuevo ğŸŒ¿' });
          setTimeout(() => setFeedback(null), 1200);
        }
      };

      if (mode === 'menu') {
        return (
          <section id="games" className="container mx-auto px-4 py-16">
            <div className="bg-white rounded-[3rem] shadow-2xl p-8 text-center border-t-8 border-yellow-400">
              <h2 className="text-4xl font-bold text-green-700 mb-4">ğŸ® Ponte a Prueba</h2>
              <p className="text-xl text-gray-600 mb-10">Â¡Demuestra que eres un gran explorador!</p>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <button onClick={() => startMode('layers')} className="bg-blue-100 hover:bg-blue-200 p-8 rounded-3xl border-b-8 border-blue-400 transition-all active:translate-y-2">
                  <div className="text-5xl mb-2">ğŸ </div>
                  <div className="font-bold text-blue-800">Â¿DÃ³nde vivo?</div>
                </button>
                <button onClick={() => startMode('movement')} className="bg-green-100 hover:bg-green-200 p-8 rounded-3xl border-b-8 border-green-400 transition-all active:translate-y-2">
                  <div className="text-5xl mb-2">ğŸ¾</div>
                  <div className="font-bold text-green-800">Â¿CÃ³mo me muevo?</div>
                </button>
                <button onClick={() => startMode('speed')} className="bg-orange-100 hover:bg-orange-200 p-8 rounded-3xl border-b-8 border-orange-400 transition-all active:translate-y-2">
                  <div className="text-5xl mb-2">âš¡</div>
                  <div className="font-bold text-orange-800">El mÃ¡s rÃ¡pido</div>
                </button>
              </div>
            </div>
          </section>
        );
      }

      return (
        <section className="container mx-auto px-4 py-16">
          <div className="bg-white rounded-[3rem] shadow-2xl p-8 max-w-2xl mx-auto border-t-8 border-green-500 relative">
            <button onClick={() => setMode('menu')} className="absolute top-4 right-6 text-gray-300 text-3xl hover:text-red-500">âœ–</button>
            <div className="flex justify-between items-center mb-10">
              <span className="bg-yellow-400 text-yellow-900 px-6 py-2 rounded-full font-bold text-lg">Puntos: {score}</span>
            </div>

            {question && (
              <div className="text-center">
                <div className="mb-10">
                  <div className="text-9xl animate-bounce mb-4">
                    {mode === 'speed' ? 'ğŸ' : question.animal.icon}
                  </div>
                  <h3 className="text-3xl font-bold text-gray-800">
                    {mode === 'layers' && `Â¿En quÃ© capa vive el ${question.animal.name}?`}
                    {mode === 'movement' && `Â¿CÃ³mo se desplaza el ${question.animal.name}?`}
                    {mode === 'speed' && `Â¿CuÃ¡l de estos es el mÃ¡s veloz?`}
                  </h3>
                </div>

                <div className="grid grid-cols-2 gap-4">
                  {mode === 'layers' && Object.keys(LAYERS).map(key => (
                    <button key={key} onClick={() => handleAnswer(key)} className={`${LAYERS[key].color} p-4 rounded-2xl font-bold hover:brightness-95 transition`}>
                      {LAYERS[key].title.split('(')[0]}
                    </button>
                  ))}
                  {mode === 'movement' && ['walk', 'fly', 'swim'].map(t => (
                    <button key={t} onClick={() => handleAnswer(t)} className="bg-gray-100 p-6 rounded-2xl text-xl font-bold hover:bg-gray-200">
                      {t === 'walk' ? 'ğŸ¾ Camina' : t === 'fly' ? 'ğŸ¦… Vuela' : 'ğŸŒŠ Nada'}
                    </button>
                  ))}
                  {mode === 'speed' && question.options.map(opt => (
                    <button key={opt.id} onClick={() => handleAnswer(opt.id)} className="bg-orange-50 p-6 rounded-2xl text-xl font-bold hover:bg-orange-100">
                      {opt.icon} {opt.name}
                    </button>
                  ))}
                </div>
              </div>
            )}

            {feedback && (
              <div className={`mt-8 p-4 rounded-2xl text-center font-bold text-2xl animate-pulse ${feedback.type === 'success' ? 'text-green-600' : 'text-red-500'}`}>
                {feedback.text}
              </div>
            )}
          </div>
        </section>
      );
    };

    // --- COMPONENTE PRINCIPAL ---
    const App = () => {
      const [activeLayer, setActiveLayer] = useState('emergente');
      const [filter, setFilter] = useState('all');

      const filteredAnimals = useMemo(() => 
        ANIMALS.filter(a => filter === 'all' || a.type === filter)
      , [filter]);

      // FunciÃ³n segura para el scroll
      const scrollToSection = (id) => {
        const element = document.getElementById(id);
        if(element) element.scrollIntoView({behavior: 'smooth'});
      };

      return (
        <div className="min-h-screen">
          <nav className="sticky top-0 z-50 bg-green-500 shadow-lg p-4 rounded-b-3xl mx-2 md:mx-8 mt-2">
            <div className="container mx-auto flex justify-between items-center text-white">
              <div className="font-bold text-2xl">ğŸ¦ MisiÃ³n Selva</div>
              <div className="flex gap-4">
                <button onClick={() => scrollToSection('habitat')} className="font-bold hover:text-yellow-200 transition">Hogar</button>
                <button onClick={() => scrollToSection('games')} className="bg-yellow-400 text-yellow-900 px-4 py-1 rounded-full font-bold hover:bg-yellow-300 transition">Â¡Jugar!</button>
              </div>
            </div>
          </nav>

          <header className="container mx-auto px-4 py-16 text-center">
            <div className="bg-white rounded-[3rem] shadow-2xl p-10 max-w-4xl mx-auto border-b-8 border-green-500">
              <div className="text-7xl mb-6">ğŸŒ¿ğŸ”ğŸ¦œ</div>
              <h1 className="text-4xl md:text-6xl font-bold text-green-600 mb-6">Â¡Hola, Explorador!</h1>
              <p className="text-xl text-gray-600 mb-10">Hoy aprenderemos sobre la selva y sus misterios.</p>
              <button onClick={() => scrollToSection('games')} className="bg-orange-500 hover:bg-orange-600 text-white font-bold py-4 px-12 rounded-full text-2xl shadow-lg transition transform hover:scale-105">
                Â¡Ponte a Prueba! ğŸ®
              </button>
            </div>
          </header>

          <section id="habitat" className="container mx-auto px-4 py-12">
            <h2 className="text-3xl font-bold text-center text-green-700 mb-10">ğŸ  Las Capas de la Selva</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-10 max-w-5xl mx-auto">
              <div className="flex flex-col h-[500px] rounded-3xl overflow-hidden shadow-2xl border-4 border-green-800">
                {Object.entries(LAYERS).map(([key, layer]) => (
                  <div key={key} onClick={() => setActiveLayer(key)} className={`flex-1 ${layer.color} flex items-center justify-center cursor-pointer transition-all ${activeLayer === key ? 'ring-inset ring-8 ring-yellow-400' : ''}`}>
                    <span className="text-4xl">{layer.icon}</span>
                  </div>
                ))}
              </div>
              <div className="bg-white rounded-3xl p-10 shadow-xl flex flex-col items-center justify-center border-t-8 border-yellow-400">
                <div className="text-8xl mb-6 animate-float">{LAYERS[activeLayer].icon}</div>
                <h3 className="text-3xl font-bold text-green-800 mb-4">{LAYERS[activeLayer].title}</h3>
                <p className="text-xl text-center text-gray-600">{LAYERS[activeLayer].desc}</p>
              </div>
            </div>
          </section>

          <section className="bg-green-50 py-20 mt-12">
            <div className="container mx-auto px-4">
              <h2 className="text-3xl font-bold text-center text-green-700 mb-10">ğŸ“¸ Ãlbum de Animales</h2>
              <div className="flex justify-center gap-3 mb-10 overflow-x-auto p-2">
                {['all', 'walk', 'fly', 'swim'].map(t => (
                  <button key={t} onClick={() => setFilter(t)} className={`px-6 py-2 rounded-full font-bold shadow ${filter === t ? 'bg-green-600 text-white' : 'bg-white text-green-800'}`}>
                    {t === 'all' ? 'Todos' : t === 'walk' ? 'Caminan' : t === 'fly' ? 'Vuelan' : 'Nadan'}
                  </button>
                ))}
              </div>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-6 max-w-6xl mx-auto">
                {filteredAnimals.map(a => (
                  <div key={a.id} className="bg-white p-6 rounded-3xl text-center shadow-lg border-b-4 border-green-200">
                    <div className="text-6xl mb-2">{a.icon}</div>
                    <div className="font-bold text-xl">{a.name}</div>
                  </div>
                ))}
              </div>
            </div>
          </section>

          <JungleCharts />
          <JungleGames />

          <footer className="bg-green-700 text-white py-20 text-center rounded-t-[4rem]">
            <div className="text-5xl mb-4">ğŸ†</div>
            <h2 className="text-4xl font-bold mb-4">Â¡Eres un SÃºper Explorador!</h2>
            <p className="text-xl opacity-80">Gracias por cuidar la selva conmigo.</p>
          </footer>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
